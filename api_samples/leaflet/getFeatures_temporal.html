<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<script src="http://maps.kosmosnimki.ru/api/apil.js?key=5174DBDFDF799681C316E0E7C6ADFF08" charset="windows-1251"></script> 

<title>GeoMixer API - примеры использования</title>
</head>
<body>
<table><tbody><tr>
	<td style="vertical-align: top;">
		<div id="map" style="width: 800px; height: 600px;"></div> <!--задаем контейнер, в который загружается карта -->
	</td>
	<td valign="top">
		<div id="result"></div>
	</td>
</tr></tbody></table>
<script>

var div = document.getElementById('map');

createFlashMap(div, 'maps.kosmosnimki.ru', "UIRCQ",
	function (map) 
	{
		map.moveTo(48.109130, 46.660157, 8);

		var myLayer = map.layers['Съёмка'];
		myLayer.setVisible(false);

		var dt1 = new Date('12/16/2012');
		var d1 = Math.floor(dt1.getTime() / 1000 - dt1.getTimezoneOffset()*60);
		var dt2 = new Date('12/17/2012');
		var d2 = Math.floor(dt2.getTime() / 1000 - dt2.getTimezoneOffset()*60);
		var f = '"unixTimeStamp" >= ' + d1 + ' AND "unixTimeStamp" <= ' + d2;
		
		for (var i = 0; i < myLayer.filters.length; i++) {
			myLayer.setVisibilityFilter(f);
		}
		myLayer.setDateInterval(new Date('01/01/1980'), new Date());

		var callback = function(arr)
		{
			console.log('addObserver ' , arr.length);
		}
		myLayer.addObserver(callback, {'ignoreVisibilityFilter':true});
		myLayer.setVisible(true);
	}
);

</script>

</body>
</html>
